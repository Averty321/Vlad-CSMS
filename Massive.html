<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генератор наклеек для приборов</title>
    <style>
        /* Стили остаются без изменений */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f8ff;
            color: #003366;
            line-height: 1.6;
        }

        h1 {
            color: #005b96;
            text-align: center;
            margin-bottom: 25px;
            font-weight: 500;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0, 91, 150, 0.1);
            border: 1px solid #d1e3f6;
        }

        label {
            display: inline-block;
            width: 180px;
            margin-bottom: 12px;
            color: #005b96;
            font-weight: 500;
        }

        input, select {
            padding: 10px;
            width: 220px;
            margin-bottom: 12px;
            border: 1px solid #b8d4f0;
            border-radius: 4px;
            background-color: white;
            color: #003366;
        }

        button {
            padding: 10px 18px;
            margin-right: 12px;
            margin-top: 12px;
            cursor: pointer;
            background: #0077cc;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: 500;
            transition: all 0.2s;
            box-shadow: 0 2px 5px rgba(0, 91, 150, 0.1);
        }

        button:hover {
            background: #005fa3;
            transform: translateY(-1px);
        }

        button:disabled {
            background: #b8d4f0;
            cursor: not-allowed;
            transform: none;
        }

        table {
            margin-top: 25px;
            border-collapse: collapse;
            width: 100%;
            background: white;
            box-shadow: 0 2px 10px rgba(0, 91, 150, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            border: 1px solid #d1e3f6;
            padding: 12px;
            text-align: center;
        }

        th {
            background-color: #0077cc;
            color: white;
            position: sticky;
            top: 0;
            font-weight: 500;
        }

        tr:nth-child(even) {
            background-color: #f5faff;
        }

        .editable {
            background: #e6f2ff;
        }

        .group-header {
            background-color: #0077cc;
            color: white;
            padding: 15px;
            margin-top: 25px;
            border-radius: 8px 8px 0 0;
            font-weight: 500;
            box-shadow: 0 2px 10px rgba(0, 91, 150, 0.1);
        }

        .group-container {
            margin-bottom: 35px;
            border: 1px solid #d1e3f6;
            border-radius: 8px;
            background: white;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 91, 150, 0.1);
        }

        .save-group-btn {
            background: #00a0e9;
            float: right;
        }

        .save-group-btn:hover {
            background: #0088c7;
        }

        #tableContainer {
            max-height: 650px;
            overflow-y: auto;
            margin-top: 25px;
            padding: 5px;
        }

        /* Стиль для скролла */
        #tableContainer::-webkit-scrollbar {
            width: 8px;
        }

        #tableContainer::-webkit-scrollbar-track {
            background: #f0f8ff;
        }

        #tableContainer::-webkit-scrollbar-thumb {
            background: #0077cc;
            border-radius: 4px;
        }
        
        /* Стиль для кнопки загрузки Excel */
        .file-input-container {
            margin-top: 15px;
        }
        
        .file-input-label {
            display: inline-block;
            padding: 10px 15px;
            background: #0077cc;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .file-input-label:hover {
            background: #005fa3;
        }
        
        #excelFile {
            display: none;
        }
        
        /* Стиль для поля ввода пользовательского количества */
        #customCountContainer {
            display: none;
            margin-top: 10px;
        }
        
        #customCount {
            width: 200px;
        }
    </style>
</head>
<body>
    <h1>Настройка наклеек</h1>
    <p class="instructions">
        Для заполнения пустых ячеек в столбцах таблицы (квитанции, типы приборов, диапазоны):<br>
        1. Убедитесь, что есть две ячейки с одинаковой информацией (например: "Счетчик" ... [пусто] ... "Счетчик")<br>
        2. Нажмите "Заполнить пустые ячейки" - все промежуточные пустые ячейки заполнятся автоматически. (можно выполнять опирацию много раз)<br>
        Для группирования схожих по номерам квитанции, типам, диапазонам необходимо нажать на "Сгруппировать" и после будет доступна возможность выгрузить массив через кнопку "сохранить группу"<br>
        Для загрузки данных с таблицы водоканала необходимо создать таблицу по первому номеру клейма-наклейки. <br>
Затем нажать загрузить данные из Excel и выбрать файл с таблицей, после чего вся информация будет перенесена в таблицу массива. <br>
    </p>
    <div class="controls">
        <label for="stickerNumber">Начальный номер наклейки:</label>
        <input type="number" id="stickerNumber" min="1" required>
        <br>
        <label for="size">Размер наклейки:</label>
        <select id="size">
            <option value="16">16 мм (64 наклейки)</option>
            <option value="10">10 мм (144 наклейки)</option>
            <option value="custom">Свое количество</option>
        </select>
        <br>
        <div id="customCountContainer">
            <label for="customCount">Количество наклеек:</label>
            <input type="number" id="customCount" min="1" max="1000" value="100">
        </div>
        <button id="createTable">Создать таблицу</button>
        <button id="clearData" disabled>Очистить страницу</button>
        <button id="groupData" disabled>Сгруппировать</button>
        <button id="fillEmpty" disabled>Заполнить пустые ячейки</button>
        <button id="saveAll" disabled>Сохранить все данные</button>
        
        <div class="file-input-container">
            <label for="excelFile" class="file-input-label">Загрузить данные из Excel</label>
            <input type="file" id="excelFile" accept=".xlsx" />
        </div>
    </div>

    <div id="tableContainer"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        let isGrouped = false;
        let originalTableData = [];

        document.addEventListener('DOMContentLoaded', function() {
            loadSavedData();

            document.getElementById('createTable').addEventListener('click', createTable);
            document.getElementById('clearData').addEventListener('click', clearData);
            document.getElementById('groupData').addEventListener('click', toggleGrouping);
            document.getElementById('fillEmpty').addEventListener('click', fillEmptyCells);
            document.getElementById('saveAll').addEventListener('click', exportAllToExcel);
            document.getElementById('excelFile').addEventListener('change', handleExcelUpload);
            
            // Обработчик изменения выбора размера
            document.getElementById('size').addEventListener('change', function() {
                const customCountContainer = document.getElementById('customCountContainer');
                if (this.value === 'custom') {
                    customCountContainer.style.display = 'block';
                } else {
                    customCountContainer.style.display = 'none';
                }
            });
        });

        function handleExcelUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                
                // Получаем первый лист
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                
                // Получаем все данные из листа
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, defval: '' });
                
                // Заполняем таблицу данными из Excel
                fillTableFromExcelData(jsonData);
            };
            reader.readAsArrayBuffer(file);
        }

        function fillTableFromExcelData(excelData) {
            const table = document.getElementById('outputTable');
            if (!table) {
                alert('Сначала создайте таблицу');
                return;
            }
            
            const rows = table.querySelectorAll('tbody tr');
            if (rows.length === 0) return;
            
            // Собираем данные из указанных ячеек Excel
            const deviceNumbers = [];
            const deviceTypes = [];
            const ranges = [];
            
            // Номера приборов (B4-23, G4-23, L4-23, B27-46, G27-46, L27-46)
            for (let row = 3; row < 23; row++) {
                if (excelData[row] && excelData[row][1]) deviceNumbers.push(excelData[row][1]);
            }
            for (let row = 3; row < 23; row++) {
                if (excelData[row] && excelData[row][6]) deviceNumbers.push(excelData[row][6]);
            }
            for (let row = 3; row < 23; row++) {
                if (excelData[row] && excelData[row][11]) deviceNumbers.push(excelData[row][11]);
            }
            for (let row = 26; row < 46; row++) {
                if (excelData[row] && excelData[row][1]) deviceNumbers.push(excelData[row][1]);
            }
            for (let row = 26; row < 46; row++) {
                if (excelData[row] && excelData[row][6]) deviceNumbers.push(excelData[row][6]);
            }
            for (let row = 26; row < 46; row++) {
                if (excelData[row] && excelData[row][11]) deviceNumbers.push(excelData[row][11]);
            }
            
            // Типы приборов (C4-23, H4-23, M4-23, C27-46, H27-46, M27-46)
            for (let row = 3; row < 23; row++) {
                if (excelData[row] && excelData[row][2]) deviceTypes.push(excelData[row][2]);
            }
            for (let row = 3; row < 23; row++) {
                if (excelData[row] && excelData[row][7]) deviceTypes.push(excelData[row][7]);
            }
            for (let row = 3; row < 23; row++) {
                if (excelData[row] && excelData[row][12]) deviceTypes.push(excelData[row][12]);
            }
            for (let row = 26; row < 46; row++) {
                if (excelData[row] && excelData[row][2]) deviceTypes.push(excelData[row][2]);
            }
            for (let row = 26; row < 46; row++) {
                if (excelData[row] && excelData[row][7]) deviceTypes.push(excelData[row][7]);
            }
            for (let row = 26; row < 46; row++) {
                if (excelData[row] && excelData[row][12]) deviceTypes.push(excelData[row][12]);
            }
            
            // Диапазоны (E4-23, J4-23, O4-23, E27-46, J27-46, O27-46)
            for (let row = 3; row < 23; row++) {
                if (excelData[row] && excelData[row][4]) ranges.push(excelData[row][4]);
            }
            for (let row = 3; row < 23; row++) {
                if (excelData[row] && excelData[row][9]) ranges.push(excelData[row][9]);
            }
            for (let row = 3; row < 23; row++) {
                if (excelData[row] && excelData[row][14]) ranges.push(excelData[row][14]);
            }
            for (let row = 26; row < 46; row++) {
                if (excelData[row] && excelData[row][4]) ranges.push(excelData[row][4]);
            }
            for (let row = 26; row < 46; row++) {
                if (excelData[row] && excelData[row][9]) ranges.push(excelData[row][9]);
            }
            for (let row = 26; row < 46; row++) {
                if (excelData[row] && excelData[row][14]) ranges.push(excelData[row][14]);
            }
            
            // Заполняем таблицу данными
            const maxRows = Math.min(rows.length, deviceNumbers.length, deviceTypes.length, ranges.length);
            
            for (let i = 0; i < maxRows; i++) {
                const row = rows[i];
                
                // Номер прибора (теперь ячейка 4 вместо 5)
                if (deviceNumbers[i] && row.cells[4]) {
                    row.cells[4].textContent = deviceNumbers[i];
                }
                
                // Тип прибора (ячейка 3)
                if (deviceTypes[i] && row.cells[3]) {
                    row.cells[3].textContent = deviceTypes[i];
                }
                
                // Диапазон (теперь ячейка 5 вместо 4)
                if (ranges[i] && row.cells[5]) {
                    row.cells[5].textContent = ranges[i];
                }
            }
            
            saveDataToLocalStorage();
            alert(`Загружено ${maxRows} строк данных из Excel файла`);
        }

        function createTable() {
            const stickerNumber = parseInt(document.getElementById('stickerNumber').value);
            const size = document.getElementById('size').value;
            let totalRows;

            if (isNaN(stickerNumber)) {
                alert('Пожалуйста, введите начальный номер наклейки');
                return;
            }

            // Определяем количество строк в зависимости от выбора
            if (size === "16") {
                totalRows = 64;
            } else if (size === "10") {
                totalRows = 144;
            } else if (size === "custom") {
                totalRows = parseInt(document.getElementById('customCount').value);
                if (isNaN(totalRows) || totalRows < 1) {
                    alert('Пожалуйста, введите корректное количество наклеек');
                    return;
                }
            }

            const tableContainer = document.getElementById('tableContainer');
            tableContainer.innerHTML = '';

            let tableHTML = `
                <table id="outputTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Номер наклейки</th>
                            <th>Номер квитанции</th>
                            <th>Тип прибора</th>
                            <th>Номер прибора</th>
                            <th>Диапазон</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            for (let i = 0; i < totalRows; i++) {
                tableHTML += `
                    <tr data-original-index="${i}">
                        <td>${i + 1}</td>
                        <td>${stickerNumber + i}</td>
                        <td class="editable account-number" contenteditable="true"></td>
                        <td class="editable device-type" contenteditable="true"></td>
                        <td class="editable device-number" contenteditable="true"></td>
                        <td class="editable range" contenteditable="true"></td>
                    </tr>
                `;
            }

            tableHTML += `</tbody></table>`;
            tableContainer.innerHTML = tableHTML;

            document.getElementById('clearData').disabled = false;
            document.getElementById('groupData').disabled = false;
            document.getElementById('fillEmpty').disabled = false;
            document.getElementById('saveAll').disabled = false;

            saveDataToLocalStorage();
            setupEditableCells();
        }

        function setupEditableCells() {
            const cells = document.querySelectorAll('td[contenteditable="true"]');

            cells.forEach(cell => {
                cell.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        const row = cell.parentNode;
                        const nextRow = row.nextElementSibling;

                        if (nextRow) {
                            const cellIndex = Array.from(row.cells).indexOf(cell);
                            nextRow.cells[cellIndex].focus();
                        }
                    }
                });

                cell.addEventListener('blur', saveDataToLocalStorage);
            });
        }

        function fillEmptyCells() {
            const table = document.getElementById('outputTable');
            if (!table) return;

            const rows = Array.from(table.querySelectorAll('tbody tr'));
            let filledDeviceNumbers = 0;
            let filledAccounts = 0;
            let filledDeviceTypes = 0;
            let filledRanges = 0;

            // 1. Заполняем номера приборов (если пустые - номером наклейки)
            rows.forEach(row => {
                const stickerNum = row.cells[1].textContent;
                const deviceNumCell = row.cells[4]; // Теперь ячейка 4 вместо 5

                if (!deviceNumCell.textContent.trim()) {
                    deviceNumCell.textContent = stickerNum;
                    filledDeviceNumbers++;
                }
            });

            // 2. Заполняем пустые ячейки для каждого столбца (квитанции, типы, диапазоны)
            const columns = [
                { index: 2, name: "квитанции", count: 0 }, // Номер квитанции
                { index: 3, name: "типы приборов", count: 0 }, // Тип прибора
                { index: 5, name: "диапазоны", count: 0 } // Диапазон (теперь ячейка 5 вместо 4)
            ];

            // Для каждого столбца выполняем заполнение
            columns.forEach(col => {
                // Находим все заполненные позиции
                const filledPositions = [];
                rows.forEach((row, idx) => {
                    const cell = row.cells[col.index];
                    if (cell.textContent.trim()) {
                        filledPositions.push({
                            index: idx,
                            value: cell.textContent.trim()
                        });
                    }
                });

                // Заполняем промежутки между одинаковыми значениями
                for (let i = 0; i < filledPositions.length - 1; i++) {
                    const current = filledPositions[i];
                    const next = filledPositions[i + 1];

                    if (current.value === next.value) {
                        // Заполняем все пустые ячейки между ними
                        for (let j = current.index + 1; j < next.index; j++) {
                            const cell = rows[j].cells[col.index];
                            if (!cell.textContent.trim()) {
                                cell.textContent = current.value;
                                col.count++;
                            }
                        }
                    }
                }
            });

            // Собираем статистику
            filledAccounts = columns[0].count;
            filledDeviceTypes = columns[1].count;
            filledRanges = columns[2].count;

            if (filledDeviceNumbers > 0 || filledAccounts > 0 || filledDeviceTypes > 0 || filledRanges > 0) {
                saveDataToLocalStorage();
                let message = "Заполнено ячеек:\n";
                if (filledDeviceNumbers > 0) message += `- Номера приборов: ${filledDeviceNumbers}\n`;
                if (filledAccounts > 0) message += `- Номера квитанций: ${filledAccounts}\n`;
                if (filledDeviceTypes > 0) message += `- Типы приборов: ${filledDeviceTypes}\n`;
                if (filledRanges > 0) message += `- Диапазоны: ${filledRanges}`;
                alert(message);
            } else {
                alert("Нет ячеек для заполнения по заданным правилам");
            }
        }

        function toggleGrouping() {
            if (isGrouped) {
                restoreOriginalTable();
            } else {
                groupData();
            }
        }

        function groupData() {
            const table = document.getElementById('outputTable');
            if (!table) return;

            originalTableData = Array.from(table.rows).map(row => Array.from(row.cells).map(cell => cell.innerHTML));

            const rows = Array.from(table.querySelectorAll('tbody tr'));
            const groups = {};

            rows.forEach(row => {
                const account = row.cells[2].textContent.trim();
                const deviceType = row.cells[3].textContent.trim();
                const range = row.cells[5].textContent.trim(); // Теперь ячейка 5 вместо 4

                if (!account && !deviceType && !range) return;

                const groupKey = `${account || 'Без номера'}|${deviceType || 'Без типа'}|${range || 'Без диапазона'}`;

                if (!groups[groupKey]) {
                    groups[groupKey] = {
                        account: account,
                        deviceType: deviceType,
                        range: range,
                        rows: []
                    };
                }

                groups[groupKey].rows.push(row.outerHTML);
            });

            const tableContainer = document.getElementById('tableContainer');
            tableContainer.innerHTML = '';

            for (const [key, group] of Object.entries(groups)) {
                const groupContainer = document.createElement('div');
                groupContainer.className = 'group-container';

                const [account, deviceType, range] = key.split('|');

                groupContainer.innerHTML = `
                    <div class="group-header">
                        Номер квитанции: ${account} | 
                        Тип прибора: ${deviceType} | 
                        Диапазон: ${range}
                        <button class="save-group-btn" 
                                data-account="${account}" 
                                data-device-type="${deviceType}" 
                                data-range="${range}">
                            Сохранить группу
                        </button>
                    </div>
                    <table class="group-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Номер наклейки</th>
                                <th>Номер квитанции</th>
                                <th>Тип прибора</th>
                                <th>Номер прибора</th>
                                <th>Диапазон</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${group.rows.join('')}
                        </tbody>
                    </table>
                `;

                tableContainer.appendChild(groupContainer);
            }

            document.querySelectorAll('.save-group-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const account = this.getAttribute('data-account');
                    const deviceType = this.getAttribute('data-device-type');
                    const range = this.getAttribute('data-range');
                    const groupTable = this.closest('.group-container').querySelector('.group-table');
                    exportGroupToExcel(groupTable, account, deviceType, range);
                });
            });

            isGrouped = true;
            document.getElementById('groupData').textContent = 'Вернуться к таблице';
            document.getElementById('fillEmpty').disabled = true;
        }

        function restoreOriginalTable() {
            if (!originalTableData.length) return;

            const tableContainer = document.getElementById('tableContainer');
            tableContainer.innerHTML = `
                <table id="outputTable">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Номер наклейки</th>
                            <th>Номер квитанции</th>
                            <th>Тип прибора</th>
                            <th>Номер прибора</th>
                            <th>Диапазон</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${originalTableData.slice(1).map(row => `
                            <tr>
                                ${row.map((cell, i) => 
                                    i > 0 ? `<td class="${i === 2 ? 'account-number' : i === 3 ? 'device-type' : i === 4 ? 'device-number' : i === 5 ? 'range' : ''} ${i > 1 ? 'editable' : ''}" ${i > 1 ? 'contenteditable="true"' : ''}>${cell}</td>` 
                                    : `<td>${cell}</td>`
                                ).join('')}
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;

            setupEditableCells();
            isGrouped = false;
            document.getElementById('groupData').textContent = 'Сгруппировать';
            document.getElementById('fillEmpty').disabled = false;
        }

        function exportGroupToExcel(table, account, deviceType, range) {
            const wb = XLSX.utils.book_new();

            // Создаем массив только с нужными колонками
            const data = [
                ['', ''] // Заголовки
            ];

            // Собираем данные только из нужных столбцов
            const rows = table.querySelectorAll('tbody tr');
            rows.forEach(row => {
                const cells = row.cells;
                data.push([
                    cells[1].textContent, // Номер наклейки
                    cells[4].textContent  // Номер прибора (теперь ячейка 4 вместо 5)
                ]);
            });

            // Создаем лист из массива данных
            const ws = XLSX.utils.aoa_to_sheet(data);
            XLSX.utils.book_append_sheet(wb, ws, 'Наклейки');

            // Исправляем имя файла (убираем спецсимволы)
            const fileName = `Наклейки_${account || 'Без номера'}_${deviceType || 'Без типа'}_${range || 'Без диапазона'}`
                .replace(/[\/\\:*?"<>|]/g, '') // Удаляем запрещенные символы
                .replace(/\s+/g, '_')          // Заменяем пробелы на подчеркивания
                .substring(0, 100) + '.xlsx';  // Ограничиваем длину

            XLSX.writeFile(wb, fileName);
        }

        function exportAllToExcel() {
            const table = document.getElementById('outputTable');
            if (!table) return;

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.table_to_sheet(table);
            XLSX.utils.book_append_sheet(wb, ws, 'Все наклейки');

            const stickerNumber = document.getElementById('stickerNumber').value;
            const size = document.getElementById('size').value;

            // Исправляем имя файла
            const fileName = `Наклейки_${stickerNumber}_${size}мм.xlsx`
                .replace(/[\/\\:*?"<>|]/g, '')
                .replace(/\s+/g, '_');

            XLSX.writeFile(wb, fileName);
        }

        function saveDataToLocalStorage() {
            const table = document.getElementById('outputTable');
            if (!table) return;

            const stickerNumber = document.getElementById('stickerNumber').value;
            const size = document.getElementById('size').value;
            const customCount = document.getElementById('customCount').value;

            localStorage.setItem('stickerNumber', stickerNumber);
            localStorage.setItem('size', size);
            localStorage.setItem('customCount', customCount);
            localStorage.setItem('stickerData', table.outerHTML);
        }

        function loadSavedData() {
            const savedData = localStorage.getItem('stickerData');
            if (savedData) {
                document.getElementById('tableContainer').innerHTML = savedData;
                document.getElementById('stickerNumber').value = localStorage.getItem('stickerNumber') || '';
                document.getElementById('size').value = localStorage.getItem('size') || '16';
                document.getElementById('customCount').value = localStorage.getItem('customCount') || '100';

                // Показываем/скрываем поле для пользовательского количества
                const customCountContainer = document.getElementById('customCountContainer');
                if (localStorage.getItem('size') === 'custom') {
                    customCountContainer.style.display = 'block';
                } else {
                    customCountContainer.style.display = 'none';
                }

                document.getElementById('clearData').disabled = false;
                document.getElementById('groupData').disabled = false;
                document.getElementById('fillEmpty').disabled = false;
                document.getElementById('saveAll').disabled = false;

                setupEditableCells();
            }
        }

        function clearData() {
            if (!confirm('Вы уверены, что хотите очистить все данные?')) return;

            localStorage.removeItem('stickerData');
            localStorage.removeItem('stickerNumber');
            localStorage.removeItem('size');
            localStorage.removeItem('customCount');
            document.getElementById('tableContainer').innerHTML = '';
            document.getElementById('clearData').disabled = true;
            document.getElementById('groupData').disabled = true;
            document.getElementById('fillEmpty').disabled = true;
            document.getElementById('saveAll').disabled = true;
            document.getElementById('groupData').textContent = 'Сгруппировать';
            isGrouped = false;
            originalTableData = [];
            
            // СБРОС ЗНАЧЕНИЯ ФАЙЛОВОГО INPUT ПРИ ОЧИСТКЕ СТРАНИЦЫ
            document.getElementById('excelFile').value = '';
        }
    </script>
</body>
</html>
