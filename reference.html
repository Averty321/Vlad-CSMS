<!DOCTYPE html>
 <html lang="ru">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Эталоны</title>
     <style>
         body {
             font-family: Arial, sans-serif;
             margin: 20px;
             padding: 0;
         }
         table {
             width: 100%;
             border-collapse: collapse;
             margin-top: 20px;
         }
         th {
             background-color: #1E90FF; /* Цвет шапки таблицы */
             color: white;              /* Белый текст */
         }
         th, td {
             border: 1px solid #ccc;
             padding: 10px;
             text-align: left;
         }
         .red {
             background-color: red;
             color: white;
         }
         .orange {
             background-color: orange;
         }
         .btn {
             cursor: pointer;
             color: blue;
             text-decoration: underline;
         }
     </style>
 </head>
 <body>
     <h1>Управление эталонами</h1>
     <button onclick="openModal()">➕ Добавить эталон</button>
 
     <table id="standardsTable">
         <thead>
             <tr>
                 <th>Наименование</th>
                 <th>Номер</th>
                 <th>Дата поверки</th>
                 <th>Осталось дней</th> <!-- Новый столбец -->
                 <th>Действия</th>
             </tr>
         </thead>
         <tbody></tbody>
     </table>
 
     <div id="modal" style="display:none;">
         <h2>Добавить/Изменить эталон</h2>
         <label>Наименование: <input type="text" id="name" required></label><br>
         <label>Номер: <input type="text" id="number" required></label><br>
         <label>Дата поверки: <input type="date" id="date" required></label><br>
         <label>Межповерочный интервал (месяцы): <input type="number" id="interval" required></label><br>
         <button onclick="saveStandard()">Сохранить</button>
         <button onclick="closeModal()">Закрыть</button>
     </div>
 
     <script>
         let standards = JSON.parse(localStorage.getItem('standards')) || [];
         let editIndex = -1;
 
         function renderTable() {
             const tbody = document.querySelector('#standardsTable tbody');
             tbody.innerHTML = '';
             standards.forEach((standard, index) => {
                 const checkDate = new Date(standard.date);
                 const now = new Date();
                 const intervalMonths = parseInt(standard.interval);
                 const dueDate = new Date(checkDate);
                 dueDate.setMonth(checkDate.getMonth() + intervalMonths);
 
                 const oneMonthBeforeDueDate = new Date(dueDate);
                 oneMonthBeforeDueDate.setMonth(dueDate.getMonth() - 1);
 
                 const daysRemaining = Math.ceil((dueDate - now) / (1000 * 60 * 60 * 24)); // Осталось дней
 
                 const row = document.createElement('tr');
 
                 if (now > dueDate) {
                     row.classList.add('red');
                 } else if (now > oneMonthBeforeDueDate) {
                     row.classList.add('orange');
                 }
 
                 row.innerHTML = `
                     <td>${standard.name}</td>
                     <td>${standard.number}</td>
                     <td>${standard.date}</td>
                     <td>${daysRemaining}</td> <!-- Удалено "дней" -->
                     <td>
                         <span class="btn" onclick="openModal(${index})">Изменить</span>
                         <span class="btn" onclick="deleteStandard(${index})">Удалить</span>
                     </td>
                 `;
                 tbody.appendChild(row);
             });
         }
 
         function openModal(index = -1) {
             editIndex = index;
             const modal = document.getElementById('modal');
             if (index >= 0) {
                 document.getElementById('name').value = standards[index].name;
                 document.getElementById('number').value = standards[index].number;
                 document.getElementById('date').value = standards[index].date;
                 document.getElementById('interval').value = standards[index].interval;
             } else {
                 document.getElementById('name').value = '';
                 document.getElementById('number').value = '';
                 document.getElementById('date').value = '';
                 document.getElementById('interval').value = '';
             }
             modal.style.display = 'block';
         }
 
         function closeModal() {
             document.getElementById('modal').style.display = 'none';
         }
 
         function saveStandard() {
             const name = document.getElementById('name').value;
             const number = document.getElementById('number').value;
             const date = document.getElementById('date').value;
             const interval = document.getElementById('interval').value;
 
             if (editIndex >= 0) {
                 standards[editIndex] = { name, number, date, interval };
             } else {
                 standards.push({ name, number, date, interval });
             }
 
             localStorage.setItem('standards', JSON.stringify(standards));
             renderTable();
             closeModal();
         }
 
         function deleteStandard(index) {
             if (confirm("Вы действительно хотите удалить этот эталон?")) {
                 standards.splice(index, 1);
                 localStorage.setItem('standards', JSON.stringify(standards));
                 renderTable();
             }
         }
 
         renderTable();
     </script>
     <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
 <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyBzKDsZJYhC0bcpdUGcAdbuiUwCY90-auM",
        authDomain: "vlad-csms.firebaseapp.com",
        databaseURL: "https://vlad-csms-default-rtdb.firebaseio.com/",
        projectId: "vlad-csms",
        storageBucket: "vlad-csms.appspot.com",
        messagingSenderId: "68047474577",
        appId: "1:68047474577:web:039d8a29e9430778ee9430"
    };

    // Инициализация Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
</script>
 </body>
 </html>
